---
description: Versioning and changelog workflow for releases
alwaysApply: true
---

# Versioning & Changelog

When making changes that will be deployed:

1. **VERSION** (repo root): Bump per Major.Feature.Patch (v0 = beta, v1 = Strava onboarded)
2. **CHANGELOG.md** (repo root): Add entries under `[Unreleased]` as you work. When releasing, move them into `[X.Y.Z]` with the release date.

**Changelog sections:** Added, Changed, Fixed, Removed, Security. Use what fits.

**Do not touch:** Terraform/infra (owner maintains manually).

See `docs/versioning.md` for full workflow.

## Environments & deployment

- **App Runner services**: staging, prod, and beta (plus single-tenant variants like `mark`, `shane`, `dom`) run in AWS App Runner.
- **Deployment script**: Use `./scripts/deploy.sh <env> vX.Y.Z` as documented in `deploy.txt` (staging first, then prod/beta).
- **App Runner rollout**: After pushing the image, trigger `aws apprunner start-deployment --service-arn <ARN> --region eu-west-1` for the target service.
- **Health check**: Verify the deployed version with `GET /version` on the target environment.

## Git workflow for this repo

- **Never work directly on `main`**: Always create a feature/patch branch (e.g. `fix-feedback-truncation-json`) before changing code.
- **AI agent behaviour**: The assistant should:
  - Create or switch to a feature branch before editing code for `my-personal-coach`.
  - Avoid committing or pushing changes unless the user explicitly requests it.
  - Treat `main` as tracking deployed state; any experimental or debugging changes live on feature branches.
